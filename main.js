const blogPosts = [

    // ORIGINS
    {
        category: "Origins",
        filter: "Origins",
        title: "The Dawnmen (First Migrants)",
        content: "According to historian H. Otley Beyer, the first inhabitants of the Philippine islands were the Dawnmen, often described as cavemen. Living about 250,000 years ago, they resembled the Java Man and Peking Man and survived through hunting and fishing, with no knowledge of agriculture. In search of food, they crossed land bridges that once connected the Philippines to Indonesia and later left for destinations unknown. It is fascinating to imagine these early humans moving across landscapes that would one day become islands shaped by history.",
        tags: ["Beyer", "Cavemen", "Pleistocene"],
        image: "img/blog/origins-dawnmen.png",
        author: "Bene Gabriel Rosel",
        date: "February 3, 2026"
    },
    {
        category: "Origins",
        filter: "Origins",
        title: "The Aetas and the Land Bridge",
        content: "About 30,000 years ago, the Aetas, also known as Negritos, crossed land bridges from Malaya, Borneo, and Australia, eventually reaching Palawan, Mindoro, and Mindanao. Skilled hunters and gatherers, they relied on spears and stone tools to survive. When the Ice Age ended and sea levels rose, the land bridges disappeared, forcing them to remain in the islands as the first permanent inhabitants. Their story reminds us how powerful natural changes can shape human settlement.",
        tags: ["Aetas", "Negritos", "Geology"],
        image: "img/blog/origins-aetas.png",
        author: "Bene Gabriel Rosel",
        date: "February 5, 2026"
    },
    {
        category: "Migration",
        filter: "Origins",
        title: "The Seafaring Indonesians",
        content: "With the disappearance of land bridges, the next wave of migrants, the Indonesians, arrived by sea. Skilled in seafaring, they were more technologically advanced than earlier groups. They used tools made of stone and steel, built sturdier houses, engaged in farming and mining, worked with brass, and wore clothing and body ornaments. Their arrival highlights how maritime skills became essential in shaping island societies.",
        tags: ["Seafaring", "Brass", "Mining"],
        image: "img/blog/origins-indonesians.png",
        author: "Bene Gabriel Rosel",
        date: "February 1, 2026"
    },
    {
        category: "Migration",
        filter: "Origins",
        title: "The Malay Innovations",
        content: "The last major prehistoric migrants were the Malays, who arrived more than 2,000 years ago. They introduced new technologies that transformed daily life, including pottery, weaving, jewelry making, metal smelting, and irrigation systems for rice planting. These innovations laid foundations that would influence Filipino societies for generations.",
        tags: ["Technology", "Irrigation", "Pottery"],
        image: "img/blog/origins-malays.png",
        author: "Bene Gabriel Rosel",
        date: "February 4, 2026"
    },
    {
        category: "Anthropology",
        filter: "Origins",
        title: "The Tabon Cave Discovery",
        content: "In 1962, archaeologists discovered a skullcap and part of a jaw in the Tabon Caves of Palawan. Dated to around 21,000 to 22,000 years ago, the remains known as Tabon Man show that humans lived in the Philippine islands far earlier than once believed. Anthropologist Felipe Landa Jocano used this evidence to support his Evolution Theory, suggesting a long process of regional evolution and migration. These discoveries continue to reshape how we understand the deep past of the Philippines.",
        tags: ["Palawan", "Evolution", "Robert Fox"],
        image: "img/blog/origins-tabon.png",
        author: "Bene Gabriel Rosel",
        date: "February 2, 2026"
    },

    // ECONOMY
    {
        category: "Settlements",
        filter: "Economy",
        title: "Ancient Manila: Lamayan",
        content: "Ancient Manila was not centered in today’s Intramuros, but along the river in an area known as Lamayan, now Sta. Ana. Because the land was low and swampy, early communities settled close to the water, turning the river into a vital lifeline. Lamayan became a busy trading hub, or entrepot, connecting many settlements around Laguna de Bay. Long before colonial walls were built, rivers already shaped the city’s importance.",
        tags: ["Manila", "Pasig River", "Sta Ana"],
        image: "img/blog/economy-manila.png",
        author: "Joeremy Christie Ong",
        date: "February 5, 2026"
    },
    {
        category: "Demographics",
        filter: "Economy",
        title: "Population Centers of the South",
        content: "By A.D. 1000, large population centers emerged in places such as Cebu, the Iloilo area, and Butuan. Archaeological finds, including high quality foreign ceramics, suggest these areas were among the major centers of overseas trade long before the Spaniards arrived. These thriving ports show how connected the islands already were to wider regional networks.",
        tags: ["Cebu", "Butuan", "Visayas"],
        image: "img/blog/economy-centers.png",
        author: "Joeremy Christie Ong",
        date: "February 1, 2026"
    },
    {
        category: "Trade",
        filter: "Economy",
        title: "The Wholesale Trust System",
        content: "Overseas trade often depended on local market networks. In some cases, Chinese merchants waited for months while their local clients distributed goods through retail and barter systems. This arrangement relied on established relationships between traders and communities, especially where ships could not dock easily. Trade, it seems, was as much about trust and cooperation as it was about goods.",
        tags: ["China", "Trade", "Commerce"],
        image: "img/blog/economy-trust.png",
        author: "Joeremy Christie Ong",
        date: "February 3, 2026"
    },
    {
        category: "Global Trade",
        filter: "Economy",
        title: "The Arab Connection",
        content: "Archaeological sites in western Batangas and northeastern Mindanao have yielded high fired ceramics dated around A.D. 1000 to 1100 or earlier. Some of these finds are linked to the Arab world and include glass vessels. These discoveries suggest that certain Philippine ports were connected, directly or indirectly, to long distance trade routes beyond Southeast Asia.",
        tags: ["Arabia", "Glass", "Trade"],
        image: "img/blog/economy-arab.png",
        author: "Joeremy Christie Ong",
        date: "February 2, 2026"
    },
    {
        category: "Industry",
        filter: "Economy",
        title: "The Iron Slag Evidence",
        content: "Ancient communities did not rely solely on imported metal. Archaeologists have found iron slags, residues from iron making, in several sites, suggesting specialized local production of metal tools. This points to organized craftsmanship and larger, more permanent communities that invested in industries beyond agriculture. Even in early times, innovation was already taking place at the local level.",
        tags: ["Metalwork", "Iron", "Industry"],
        image: "img/blog/economy-iron.png",
        author: "Joeremy Christie Ong",
        date: "February 4, 2026"
    },
    {
        category: "Agriculture",
        filter: "Economy",
        title: "The Wet Rice Revolution",
        content: "Intensive wet rice agriculture was well established in lowlands and floodplains, forming the economic backbone of many communities. With increasing contact with China and access to metal tools, farming became more efficient through the use of draft animals and plows. Rice gained prestige as a staple, shaping daily life, labor, and social relationships. Food, in this case, was never just about survival.",
        tags: ["Rice", "Farming", "Agriculture"],
        image: "img/blog/economy-rice.png",
        author: "Joeremy Christie Ong",
        date: "February 2, 2026"
    },

    // CULTURE
    {
        category: "Culture",
        filter: "Culture",
        title: "The Butuan and Tausug Connection",
        content: "Trade did more than move goods, it encouraged contact among peoples. Archaeological evidence suggests population movement from northeastern to southwestern Mindanao around A.D. 1100, alongside intense trade in Asian ceramics. Linguistic similarities between the Butuanon and Tausug languages are often discussed as clues to these historical connections. These links hint at how mobility shaped cultural exchange.",
        tags: ["Language", "Linguistics", "Mindanao"],
        image: "img/blog/culture-butuan.png",
        author: "Vhon Angelico Salilo",
        date: "February 5, 2026"
    },
    {
        category: "Archaeology",
        filter: "Culture",
        title: "The Thai Ceramic Mystery",
        content: "Thai ceramics were more commonly found in the southern Philippines and became less frequent moving north. In northern Luzon, such wares were extremely rare. This uneven distribution reflects how trade routes and access shaped what materials reached different communities.",
        tags: ["Thailand", "Ceramics", "Trade"],
        image: "img/blog/culture-thai.png",
        author: "Vhon Angelico Salilo",
        date: "February 1, 2026"
    },
    {
        category: "Artistry",
        filter: "Culture",
        title: "Batangas and Mindanao Pottery",
        content: "Pottery styles varied widely across regions. In Batangas, archaeologists found ornate Metal Age pottery with polished red surfaces and intricate designs. In northeastern Mindanao, pottery tended to be simpler in form and decoration. These differences suggest distinct local traditions, even as both areas remained connected to similar Asian trade sources.",
        tags: ["Batangas", "Mindanao", "Pottery"],
        image: "img/blog/culture-pottery.png",
        author: "Vhon Angelico Salilo",
        date: "February 3, 2026"
    },
    {
        category: "Beliefs",
        filter: "Culture",
        title: "The Sacred Water Buffalo",
        content: "The carabao, or water buffalo, was a key symbol of wealth and status in ancient societies. Essential to wet rice farming, it also held value in trade and prestige. Archaeological remains suggest these animals played roles in rituals as well. Their importance shows how belief, economy, and daily life were closely intertwined.",
        tags: ["Rituals", "Carabao", "Beliefs"],
        image: "img/blog/culture-carabao.png",
        author: "Vhon Angelico Salilo",
        date: "February 4, 2026"
    },
    {
        category: "Spirituality",
        filter: "Culture",
        title: "Heirlooms for the Dead",
        content: "Trade ceramics often traveled far beyond major ports. Ming dynasty ceramics were commonly kept as heirlooms, even in remote mountain communities, and were sometimes buried with the dead. These practices suggest that objects carried meaning beyond their material value, linking memory, family, and belief across generations.",
        tags: ["Burial", "Ming Dynasty", "Heirlooms"],
        image: "img/blog/culture-heirloom.png",
        author: "Vhon Angelico Salilo",
        date: "February 1, 2026"
    },

    // POLITICS
    {
        category: "Politics",
        filter: "Politics",
        title: "The Strategy of Alliances",
        content: "As communities grew and interacted more frequently, alliances began to extend beyond kinship ties alone. Groups sometimes united for shared goals, such as when the peoples of Zambales allied with those of Pangasinan against the Ilocano populations. These alliances reveal that political cooperation and strategy existed long before colonial rule.",
        tags: ["Alliances", "Strategy", "Luzon"],
        image: "img/blog/politics-alliances.png",
        author: "Vince Roy Lim",
        date: "February 5, 2026"
    },
    {
        category: "Social Structure",
        filter: "Politics",
        title: "Wisdom and Wealth",
        content: "Leadership was not always inherited. Often, authority went to an assertive individual defined by age, economic wealth, and wisdom. Supported by kin and community, such leaders reflect how respect and capability shaped early social organization.",
        tags: ["Leadership", "Society", "Hierarchy"],
        image: "img/blog/politics-leadership.png",
        author: "Vince Roy Lim",
        date: "February 2, 2026"
    },
    {
        category: "Governance",
        filter: "Politics",
        title: "The Southern Sultanates",
        content: "In the southern Philippines, political organization became more complex with the introduction of Islam, layered over earlier Indian influences. These systems were often adapted locally, and some prestige titles existed without formal supporting structures. Even so, societies influenced by Islam developed some of the most organized political systems in the pre colonial Philippines.",
        tags: ["Islam", "Sultanates", "Mindanao"],
        image: "img/blog/politics-sultanates.png",
        author: "Vince Roy Lim",
        date: "February 4, 2026"
    },
    {
        category: "History",
        filter: "Politics",
        title: "The Cebu and Mactan Standoff",
        content: "By the time the first Spaniards arrived in 1521, some communities had grown large enough to require higher levels of political integration. One example is the leadership stand off between the communities of Cebu and Mactan. This moment offers a glimpse into the political dynamics already at play before written colonial history began.",
        tags: ["Cebu", "Mactan", "History"],
        image: "img/blog/politics-cebu.png",
        author: "Vince Roy Lim",
        date: "February 3, 2026"
    }

];

// --- APP LOGIC ---

const blogContainer = document.getElementById('blog-feed');
const modal = document.getElementById('article-modal');
const closeBtn = document.querySelector('.close-btn');

// Elements inside modal
const modalCategory = document.getElementById('modal-category');
const modalTitle = document.getElementById('modal-title');
const modalText = document.getElementById('modal-text');
const modalTags = document.getElementById('modal-tags');
const modalImage = document.getElementById('modal-img-element');

// Filter Buttons
const filterBtns = document.querySelectorAll('.filter-btn');

function renderPosts() {
    blogContainer.innerHTML = '';

    blogPosts.forEach((post, index) => {
        const article = document.createElement('article');

        // Base card class
        article.classList.add('blog-card');

        // Color class
        // creates classes like: type-origins, type-economy, type-politics
        const typeClass = 'type-' + post.filter.toLowerCase();
        article.classList.add(typeClass);

        article.setAttribute('data-filter', post.filter);
        article.dataset.index = index; // Store index for full text search
        article.style.transitionDelay = `${index * 50}ms`;

        // Create a "Preview" version of the text
        const previewText = post.content.substring(0, 100) + '...';
        const tagsHtml = post.tags.map(tag => `<span class="tag">#${tag}</span>`).join('');
        const readTime = "1 min read";

        const shortDate = post.date.replace('February', 'Feb').replace(', 2026', '').toUpperCase();

        // Inline SVGs (Calendar & Clock)
        const calendarIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>`;
        const clockIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>`;

        // Updated HTML to use the new classes
        article.innerHTML = `
            <div class="card-header"></div>
            <div class="card-body">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
                    <span class="category" style="margin-bottom:0;">${post.category}</span>
                    <div class="meta-row">
                        <span class="meta-item">${calendarIcon} ${shortDate}</span>
                        <span class="meta-item">${clockIcon} ${readTime}</span>
                    </div>
                </div>
                <h3>${post.title}</h3>
                <p class="author-byline">By ${post.author}</p>
                <p>
                    ${previewText} 
                    <span class="read-more-btn">Read More</span>
                </p>
                <div class="tag-container">${tagsHtml}</div>
            </div>
        `;

        // Click Event to Open Modal
        article.addEventListener('click', () => {
            openModal(post);
        });

        blogContainer.appendChild(article);
    });
}

// --- FILTER LOGIC ---
// --- FILTER & SEARCH LOGIC ---
const searchInput = document.getElementById('blog-search');
let currentFilter = 'all';
let currentSearch = '';

// Initialize Filter Buttons
filterBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        // Update active class
        filterBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');

        // Update current filter
        currentFilter = btn.getAttribute('data-filter');

        // Apply unified filter
        applyFilters();
    });
});

// Initialize Search Input
if (searchInput) {
    searchInput.addEventListener('input', (e) => {
        currentSearch = e.target.value.toLowerCase().trim();
        applyFilters();
    });
}

function applyFilters() {
    const cards = document.querySelectorAll('.blog-card');
    let visibleCount = 0;

    cards.forEach(card => {
        const cardCategory = card.getAttribute('data-filter');
        const cardIndex = card.dataset.index;
        const post = blogPosts[cardIndex]; // Get full post data

        const cardTitle = post.title.toLowerCase();
        const cardContent = post.content.toLowerCase(); // Full content search
        const cardTags = post.tags.map(t => t.toLowerCase()).join(' ');
        const cardAuthor = post.author.toLowerCase();

        // Check Category Match
        const categoryMatch = (currentFilter === 'all' || cardCategory === currentFilter);

        // Check Search Match (Regex for "Start of Word")
        let searchMatch = true;
        if (currentSearch) {
            // Escape special chars to prevent regex errors
            const safeSearch = currentSearch.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            // Regex: \b matches word boundary (start of word)
            const regex = new RegExp(`\\b${safeSearch}`, 'i');

            searchMatch = (
                regex.test(post.title) ||
                regex.test(post.content) ||
                regex.test(post.tags.join(' ')) ||
                regex.test(post.author)
            );
        }

        // Show/Hide Logic
        if (categoryMatch && searchMatch) {
            card.classList.remove('hidden');
            card.classList.add('visible');

            // Staggered animation for re-appearing items
            card.style.transitionDelay = `${visibleCount * 50}ms`;
            visibleCount++;
        } else {
            card.classList.add('hidden');
            card.classList.remove('visible');
            card.style.transitionDelay = '0ms';
        }
    });
}

function openModal(post) {
    if (modalImage) {
        modalImage.src = post.image || '';
        modalImage.style.display = post.image ? 'block' : 'none';
    }
    modalCategory.textContent = post.category;
    modalTitle.textContent = post.title;
    modalText.textContent = post.content;
    modalTags.innerHTML = post.tags.map(tag => `<span class="tag">#${tag}</span>`).join('');
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    modal.classList.remove('active');
    document.body.style.overflow = 'auto';
}

// Event Listeners
closeBtn.addEventListener('click', closeModal);
modal.addEventListener('click', (e) => {
    if (e.target === modal) closeModal();
});
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && modal.classList.contains('active')) closeModal();
});

// Scroll Animation
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
        }
    });
}, { threshold: 0.1, rootMargin: "0px 0px -50px 0px" });

// Initialization
document.addEventListener('DOMContentLoaded', () => {
    renderPosts();
    const cards = document.querySelectorAll('.blog-card');
    cards.forEach(card => observer.observe(card));

    // Initialize Hero Particles
    initHeroParticles();

    // Initialize Navigation Effects
    initNavigation();

    // Initialize Back to Top Button
    initBackToTop();

    // Initialize Section Reveal Animations
    initSectionReveal();

    // Hide Loading Screen
    hideLoadingScreen();
});

// Hero Particles Animation
function initHeroParticles() {
    const particlesContainer = document.getElementById('hero-particles');
    if (!particlesContainer) return;

    const particleCount = 20;

    for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.classList.add('particle');

        // Randomize position
        particle.style.left = Math.random() * 100 + '%';
        particle.style.bottom = Math.random() * -20 + '%';

        // Randomize size
        const size = Math.random() * 4 + 2;
        particle.style.width = size + 'px';
        particle.style.height = size + 'px';

        // Randomize animation
        particle.style.animationDelay = Math.random() * 8 + 's';
        particle.style.animationDuration = (Math.random() * 4 + 6) + 's';

        particlesContainer.appendChild(particle);
    }
}

// Navigation Scroll Effects & Hamburger Menu
function initNavigation() {
    const navbar = document.getElementById('navbar');
    const hamburger = document.getElementById('hamburger');
    const navLinks = document.getElementById('nav-links');

    if (!navbar) return;

    // Navbar scroll effect
    let lastScroll = 0;

    window.addEventListener('scroll', () => {
        const currentScroll = window.pageYOffset;

        // Add scrolled class when scrolled down
        if (currentScroll > 50) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }

        lastScroll = currentScroll;
    });

    // Hamburger menu toggle
    if (hamburger && navLinks) {
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navLinks.classList.toggle('active');

            // Prevent body scroll when menu is open
            document.body.style.overflow = navLinks.classList.contains('active') ? 'hidden' : '';
        });

        // Close menu when clicking a link
        navLinks.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                hamburger.classList.remove('active');
                navLinks.classList.remove('active');
                document.body.style.overflow = '';
            });
        });

        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!navbar.contains(e.target) && navLinks.classList.contains('active')) {
                hamburger.classList.remove('active');
                navLinks.classList.remove('active');
                document.body.style.overflow = '';
            }
        });
    }
}

// Back to Top Button
function initBackToTop() {
    const backToTop = document.getElementById('back-to-top');

    if (!backToTop) return;

    // Show/hide button based on scroll position
    window.addEventListener('scroll', () => {
        if (window.pageYOffset > 400) {
            backToTop.classList.add('visible');
        } else {
            backToTop.classList.remove('visible');
        }
    });

    // Scroll to top on click
    backToTop.addEventListener('click', () => {
        window.scrollTo({
            top: 0,
            behavior: 'smooth'
        });
    });
}

// Section Reveal Animation
function initSectionReveal() {
    const sections = document.querySelectorAll('.reveal-section');

    const revealObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('revealed');
                revealObserver.unobserve(entry.target);
            }
        });
    }, { threshold: 0.15, rootMargin: "0px 0px -50px 0px" });

    sections.forEach(section => {
        revealObserver.observe(section);
    });
}

// Hide Loading Screen
function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loading-screen');
    if (loadingScreen) {
        // Small delay to ensure everything is ready
        setTimeout(() => {
            loadingScreen.classList.add('hidden');
            // Remove from DOM layout after transition
            setTimeout(() => {
                loadingScreen.style.display = 'none';
            }, 600);
        }, 800);
    }
}